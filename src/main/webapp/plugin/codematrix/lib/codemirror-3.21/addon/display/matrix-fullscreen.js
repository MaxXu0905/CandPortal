(function() {	"use strict";	CodeMirror.defineOption("fullScreen", false, function(cm, val, old) {		if (old == CodeMirror.Init)			old = false;		if (!old == !val)			return;		initToast(cm);		initBtn(cm);		if (val)			setFullscreen(cm);		else			setNormal(cm);	});	function initToast(cm) {		if (cm.state.fullScreenToast) {			return;		}		var $wrap = $(cm.getWrapperElement());		var $toast = $('<div>').addClass('toast').text('按 Esc 退出全屏模式。');		$wrap.append($toast.hide());		cm.state.fullScreenToast = $toast;	}	function initBtn(cm) {		if (cm.state.fullScreenResizeButton) {			return;		}		var $wrap = $(cm.getWrapperElement());		var $btn = $('<button>').attr({			type : 'button',			title : '退出全屏模式'		}).addClass('resize-normal btn btn-default').append(				$('<span style="line-height:20px;">').addClass('glyphicon glyphicon-resize-small'));		$btn.tooltip({			container : 'body',			placement : 'left'		});		$btn.click(function() {			if (cm.getOption("fullScreen"))				cm.setOption("fullScreen", false);		});		$wrap.append($btn.hide());		cm.state.fullScreenResizeButton = $btn;	}		var timeoutId;	function setFullscreen(cm) {		cm.state.fullScreenResizeButton.show();		var left = ($(document).width() - 420) / 2;		var top = $(document).height() / 2 - 50 * 2;		console.log(left + ":" + top)		cm.state.fullScreenToast.css({			left : left,			top : top		}).fadeTo(600, 0.8, function() {			timeoutId = setTimeout(function() {				cm.state.fullScreenToast.fadeOut();			}, 800);		});		var wrap = cm.getWrapperElement();		cm.state.fullScreenRestore = {			scrollTop : window.pageYOffset,			scrollLeft : window.pageXOffset,			width : wrap.style.width,			height : wrap.style.height		};		wrap.style.width = "";		wrap.style.height = "auto";		wrap.className += " CodeMirror-fullscreen";		document.documentElement.style.overflow = "hidden";		cm.refresh();	}	function setNormal(cm) {		cm.state.fullScreenResizeButton.hide();		cm.state.fullScreenToast.hide();		var wrap = cm.getWrapperElement();		wrap.className = wrap.className.replace(/\s*CodeMirror-fullscreen\b/, "");		document.documentElement.style.overflow = "";		var info = cm.state.fullScreenRestore;		clearTimeout(timeoutId);		wrap.style.width = info.width;		wrap.style.height = info.height;		window.scrollTo(info.scrollLeft, info.scrollTop);		cm.refresh();	}})();